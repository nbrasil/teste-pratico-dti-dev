{"ast":null,"code":"var _jsxFileName = \"/Users/nicollybrasil/Desktop/FullStack/teste-dti-dev/frontend/src/components/FlightControlPanel.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport api from '../services/api';\nimport { toast } from 'react-toastify';\nimport './FlightControlPanel.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction FlightControlPanel() {\n  _s();\n  const [flights, setFlights] = useState([]);\n  const fetchActionableFlights = useCallback(async () => {\n    try {\n      // Usa o novo parâmetro da API\n      const response = await api.get('/voos?status=actionable');\n      setFlights(response.data);\n    } catch (error) {\n      console.error(\"Erro ao buscar voos acionáveis:\", error);\n      toast.error(\"Não foi possível carregar os voos.\");\n    }\n  }, []);\n  useEffect(() => {\n    fetchActionableFlights();\n    const intervalId = setInterval(fetchActionableFlights, 10000); // Atualiza a lista a cada 10s\n    return () => clearInterval(intervalId);\n  }, [fetchActionableFlights]);\n  const handleIniciarVoo = async flightId => {\n    try {\n      await api.post(`/voos/${flightId}/iniciar`);\n      toast.success(`Voo #${flightId} iniciado!`);\n      fetchActionableFlights(); // Atualiza a lista imediatamente\n    } catch (error) {\n      toast.error(`Erro ao iniciar voo #${flightId}.`);\n    }\n  };\n  const handleFinalizarVoo = async flightId => {\n    // A PROVA REAL ESTÁ AQUI\n    console.log(`[PROVA REAL] Tentando finalizar voo #${flightId} com o método POST.`);\n    try {\n      await api.post(`/voos/${flightId}/finalizar`);\n      toast.success(`Voo #${flightId} finalizado com sucesso!`);\n      fetchActionableFlights();\n    } catch (error) {\n      console.error('Erro detalhado ao finalizar voo:', error); // Adicione um log de erro mais detalhado\n      toast.error(`Erro ao finalizar voo #${flightId}.`);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flight-panel-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Painel de Controle de Voos\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flight-list\",\n      children: flights.length === 0 ? /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Nenhum voo pendente ou em andamento.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 54,\n        columnNumber: 21\n      }, this) : flights.map(voo => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flight-card\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flight-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: [\"Voo #\", voo.id]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 59,\n            columnNumber: 33\n          }, this), \" (Drone #\", voo.drone_id, \")\", /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `status-badge status-${voo.status.toLowerCase()}`,\n            children: voo.status\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 29\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flight-actions\",\n          children: [voo.status === 'Pendente' && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleIniciarVoo(voo.id),\n            className: \"start-btn\",\n            children: \"Iniciar Voo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 64,\n            columnNumber: 37\n          }, this), voo.status === 'Em andamento' && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => handleFinalizarVoo(voo.id),\n            className: \"end-btn\",\n            children: \"Finalizar Voo\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 67,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 29\n        }, this)]\n      }, voo.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 25\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 50,\n    columnNumber: 9\n  }, this);\n}\n_s(FlightControlPanel, \"zZF9yOYyAMt9c5b8oMsQSTr2OIc=\");\n_c = FlightControlPanel;\nexport default FlightControlPanel;\nvar _c;\n$RefreshReg$(_c, \"FlightControlPanel\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","api","toast","jsxDEV","_jsxDEV","FlightControlPanel","_s","flights","setFlights","fetchActionableFlights","response","get","data","error","console","intervalId","setInterval","clearInterval","handleIniciarVoo","flightId","post","success","handleFinalizarVoo","log","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","map","voo","id","drone_id","status","toLowerCase","onClick","_c","$RefreshReg$"],"sources":["/Users/nicollybrasil/Desktop/FullStack/teste-dti-dev/frontend/src/components/FlightControlPanel.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport api from '../services/api';\nimport { toast } from 'react-toastify';\nimport './FlightControlPanel.css';\n\nfunction FlightControlPanel() {\n    const [flights, setFlights] = useState([]);\n\n    const fetchActionableFlights = useCallback(async () => {\n        try {\n            // Usa o novo parâmetro da API\n            const response = await api.get('/voos?status=actionable');\n            setFlights(response.data);\n        } catch (error) {\n            console.error(\"Erro ao buscar voos acionáveis:\", error);\n            toast.error(\"Não foi possível carregar os voos.\");\n        }\n    }, []);\n\n    useEffect(() => {\n        fetchActionableFlights();\n        const intervalId = setInterval(fetchActionableFlights, 10000); // Atualiza a lista a cada 10s\n        return () => clearInterval(intervalId);\n    }, [fetchActionableFlights]);\n\n    const handleIniciarVoo = async (flightId) => {\n        try {\n            await api.post(`/voos/${flightId}/iniciar`);\n            toast.success(`Voo #${flightId} iniciado!`);\n            fetchActionableFlights(); // Atualiza a lista imediatamente\n        } catch (error) {\n            toast.error(`Erro ao iniciar voo #${flightId}.`);\n        }\n    };\n    const handleFinalizarVoo = async (flightId) => {\n        // A PROVA REAL ESTÁ AQUI\n        console.log(`[PROVA REAL] Tentando finalizar voo #${flightId} com o método POST.`);\n    \n        try {\n            await api.post(`/voos/${flightId}/finalizar`);\n            toast.success(`Voo #${flightId} finalizado com sucesso!`);\n            fetchActionableFlights();\n        } catch (error) {\n            console.error('Erro detalhado ao finalizar voo:', error); // Adicione um log de erro mais detalhado\n            toast.error(`Erro ao finalizar voo #${flightId}.`);\n        }\n    };\n\n    return (\n        <div className=\"flight-panel-container\">\n            <h3>Painel de Controle de Voos</h3>\n            <div className=\"flight-list\">\n                {flights.length === 0 ? (\n                    <p>Nenhum voo pendente ou em andamento.</p>\n                ) : (\n                    flights.map(voo => (\n                        <div className=\"flight-card\" key={voo.id}>\n                            <div className=\"flight-info\">\n                                <strong>Voo #{voo.id}</strong> (Drone #{voo.drone_id})\n                                <span className={`status-badge status-${voo.status.toLowerCase()}`}>{voo.status}</span>\n                            </div>\n                            <div className=\"flight-actions\">\n                                {voo.status === 'Pendente' && (\n                                    <button onClick={() => handleIniciarVoo(voo.id)} className=\"start-btn\">Iniciar Voo</button>\n                                )}\n                                {voo.status === 'Em andamento' && (\n                                    <button onClick={() => handleFinalizarVoo(voo.id)} className=\"end-btn\">Finalizar Voo</button>\n                                )}\n                            </div>\n                        </div>\n                    ))\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default FlightControlPanel;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}